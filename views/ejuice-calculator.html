<div class="row" ng-init="count()">

	<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
		<div nbl-panel></div>
	</div>

	<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
		<div target-panel></div>
	</div>

	<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">

		<div class="panel panel-primary">

			<div class="panel-heading">
				<h3 class="panel-title">Flavoring</h3>
			</div>
			
			<table class="table table-condensed table-flavoring">

				<thead>
					<tr>
						<th id="name">Name</th>
						<th id="percentage">Percentage</th>
						<th id="pg">PG</th>
						<th id="vg">VG</th>
						<th id="add-remove"></th>
					</tr>
				</thead>

				<tbody class="flavoring-list">

					<tr ng-form="newFlavorF">
						<td>
							<div class="form-group flavor-name">
								<input type="text" class="form-control" name="name" maxlength="12" ng-model="flavoringP.newFlavor.name" placeholder="Flavor name">
							</div>
						</td>
						<td>
							<div class="input-group flavor-percentage" ng-class="{'has-error' : newFlavorF.percentage.$invalid && !newFlavorF.percentage.$pristine}">
								<input type="number" class="form-control  text-right" name="percentage" min="0" max="100" step="1" ng-model="flavoringP.newFlavor.percentage" required>
								<div class="input-group-addon flavor-percentage"> % </div>
							</div>
						</td>
						<td class="pg-td flavor-pg">
							<input type="radio" name="composition" value="PG" ng-model="flavoringP.newFlavor.composition">
						</td>
						<td class="vg-td flavor-vg">
							<input type="radio" name="composition" value="VG" ng-model="flavoringP.newFlavor.composition">
						</td>
						<td class="add">
							<button type="button" class="btn btn-default btn-xs" ng-disabled="newFlavorF.$invalid" ng-click="add()">
								<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
							</button>
						</td>
					</tr>

					<tr ng-form="flavoringF" ng-repeat="flavor in flavoringP.flavorList">
						<td>
							<div class="form-group flavor-name">
								<input type="text" class="form-control" name="name" maxlength="15" ng-model="flavor.name">
							</div>
						</td>
						<td>
							<div class="input-group flavor-percentage" ng-class="{'has-error' : !flavoringF.percentage.$valid}">
								<input type="number" class="form-control  text-right" name="percentage" min="0" max="100" step="1" ng-model="flavor.percentage" ng-change="count()" required>
								<div class="input-group-addon flavor-percentage"> % </div>
							</div>
						</td>
						<td class="pg-td">
							<input type="radio" name="composition_{{$index}}" value="PG" ng-model="flavor.composition" disabled="disabled">
						</td>
						<td class="vg-td">
							<input type="radio" name="composition_{{$index}}" value="VG" ng-model="flavor.composition" disabled="disabled">
						</td>
						<td class="remove">
							<button type="button" class="btn btn-default btn-xs" ng-click="remove($index)">
								<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
							</button>
						</td>
					</tr>

				</tbody>

			</table>

			<div class="panel-footer"></div>

		</div>

	</div>

	<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">

		<div class="panel panel-primary">

			<div class="panel-heading">
				<h3 class="panel-title">Final eJuice recipe</h3>
			</div>
			<div class="alert alert-danger alert-target alert-final-recipe" ng-show="ferP.pgML < 0 || ferP.vgML < 0 || ferP.totalML != targetP.amount">
				This mix is not feasible. You may need to lower your target nic, VG or PG content, or flavoring. 
				Alternatively, use a stronger nic base liquid, or a nic base liquid with a different VG/PG ratio. 
				Please adjust your settings.
			</div>
			<table class="table table-striped table-final-ej-recipe">
				
				<thead>
					<tr>
						<th id="ingredients">Ingredients</th>
						<th id="ml" class="text-right">ml</th>
					</tr>
				</thead>
				
				<tbody>
					<tr>
						<td>Nicotine base liquid</td>
						<td class="text-right">{{ferP.nblML | number:2}}</td>
					</tr>
					<tr ng-class="{'danger' : ferP.pgML < 0}">
						<td>PG</td>
						<td class="text-right">{{ferP.pgML | number:2}}</td>
					</tr>
					<tr ng-class="{'danger' : ferP.vgML < 0}">
						<td>VG</td>
						<td class="text-right">{{ferP.vgML | number:2}}</td>
					</tr>
					<tr>
						<td>Water</td>
						<td class="text-right">{{ferP.waterML | number:2}}</td>
					</tr>
					<tr ng-repeat="flavor in flavoringP.flavorList">
						<td><i>{{flavor.name}} - {{flavor.composition}}</i></td>
						<td class="text-right">{{flavor.ml | number:2}}</td>
					</tr>
				</tbody>
				
				<thead>
					<tr ng-class="{'danger' : ferP.totalML != targetP.amount}">
						<th id="total">Total</th>
						<th class="text-right" id="total-ml">{{ferP.totalML | number:2}}</th>
					</tr>
				</thead>
				
			</table>

			<div class="panel-footer"></div>

		</div>

	</div>

</div>
